name: reviewdog
on: [pull_request]

jobs:
  actionlint:
    name: runner / actionlint
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: actionlint
        uses: ./
        with:
          tool_name: actionlint
          fail_level: info
      - run: |
          [[ n != 0 ]]                      # Constant test expressions
          [[ -e *.mpg ]]                    # Existence checks of globs
          [[ $foo==0 ]]                     # Always true due to missing spaces
          [[ -n "$foo " ]]                  # Always true due to literals
          [[ $foo =~ "fo+" ]]               # Quoted regex in =~
          [ foo =~ re ]                     # Unsupported [ ] operators
          [ $1 -eq "shellcheck" ]           # Numerical comparison of strings
          [ $n && $m ]                      # && in [ .. ]
          [ grep -q foo file ]              # Command without $(..)
          [[ "$$file" == *.jpg ]]           # Comparisons that can't succeed
          (( 1 -lt 2 ))                     # Using test operators in ((..))
          [ x ] & [ y ] | [ z ]             # Accidental backgrounding and piping

  reviewdog:
    name: runner / reviewdog
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: actionlint w/ reviewdog
        uses: ./
        with:
          actionlint_flags: examples/broken-workflow.yml
          tool_name: reviewdog

  shellcheck:
    name: runner / shellcheck
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: actionlint w/ shellcheck
        uses: ./
        with:
          actionlint_flags: examples/shellcheck.yml
          tool_name: shellcheck

  pyflakes:
    name: runner / pyflakes
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: actionlint w/ pyflakes
        uses: ./
        with:
          actionlint_flags: examples/pyflakes.yml
          tool_name: pyflakes
